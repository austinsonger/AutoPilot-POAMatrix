Scan_Type,Plugin ID,CVE,CVSS,Risk,Host,Protocol,Port,Name,Synopsis,Description,Solution,See Also,Plugin Output,Asset UUID,Vulnerability State,IP Address,FQDN,NetBios,OS,MAC Address,Plugin Family,CVSS Base Score,CVSS Temporal Score,CVSS Temporal Vector,CVSS Vector,CVSS3 Base Score,CVSS3 Temporal Score,CVSS3 Temporal Vector,CVSS3 Vector,System Type,Host Start,Host End,Vulnerability Priority Rating (VPR),First Found,Last Found,Host Scan Schedule ID,Host Scan ID,Indexed At,Last Authenticated Results Date,Last Unauthenticated Results Date,Tracked,Risk Factor,Severity,Original Severity,Modification,Plugin Family ID,Plugin Type,Plugin Version,Service,Plugin Modification Date,Plugin Publication Date,Checks for Malware,Exploit Available,Exploited by Malware,Exploited by Nessus,CANVAS,D2 Elliot,Metasploit,Core Exploits,ExploitHub,Default Account,Patch Available,In The News,Unsupported By Vendor,Last Fixed
Vulnerability Scan,10107,,0,,www.REDACTED.com,TCP,443,HTTP Server Type and Version,A web server is running on the remote host.,This plugin attempts to determine the type and the version of the   remote web server.,,,"The remote web server type is :

nginx",c9f15957-23d1-4cdb-9e18-10dbb14cb8eb,Active,0.000.00.00,www.REDACTED.com,,Linux Kernel 4.1,,Web Servers,0,0,,,0,0,,,unknown,2024-10-01T04:04:26.550Z,2024-10-01T05:33:17.652Z,,2024-05-15T14:24:55.917Z,2024-10-01T05:33:17.652Z,127d8fef-ce71-558e-cf3a-110f3185c918c096677cdeae28bf,05d3ad30-7e24-467f-978b-366638571a88,2024-10-01T05:40:26.617Z,,2024-10-01T05:32:19Z,True,,0.0,0.0,NONE,11,remote,1.141,www,2020-10-30T00:00:00Z,2000-01-04T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
Vulnerability Scan,10386,,0,,www.REDACTED.com,TCP,80,Web Server No 404 Error Code Check,The remote web server does not return 404 error codes.,"The remote web server is configured such that it does not return '404 Not Found' error codes when a nonexistent file is requested, perhaps returning instead a site map, search page or authentication page.

Nessus has enabled some counter measures for this.  However, they might be insufficient.  If a great number of security holes are produced for this port, they might not all be accurate.",,,"

CGI scanning will be disabled for this host because the host responds
to requests for non-existent URLs with HTTP code 301
rather than 404. The requested URL was : 

    http://www.REDACTED.com/GaMxKOGHR5fs.html
",c9f15957-23d1-4cdb-9e18-10dbb14cb8eb,Active,0.000.00.00,www.REDACTED.com,,Linux Kernel 4.1,,Web Servers,0,0,,,0,0,,,unknown,2024-10-01T04:04:26.550Z,2024-10-01T05:33:17.652Z,,2024-05-15T14:24:55.917Z,2024-10-01T05:33:17.652Z,127d8fef-ce71-558e-cf3a-110f3185c918c096677cdeae28bf,05d3ad30-7e24-467f-978b-366638571a88,2024-10-01T05:40:26.616Z,,2024-10-01T05:32:19Z,True,,0.0,0.0,NONE,11,remote,1.1,www,2022-06-17T00:00:00Z,2000-04-28T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
Vulnerability Scan,10662,,0,,www.REDACTED.com,TCP,443,Web mirroring,Nessus can crawl the remote website.,"This plugin makes a mirror of the remote website(s) and extracts the list of CGIs that are used by the remote host. 

It is suggested that you change the number of pages to mirror in the 'Options' section of the client.",,,"
Webmirror performed 68 queries in 50s (1.0360 queries per second)

The following CGIs have been discovered :


+ CGI : /api_v2/workflow/processor
  Methods : POST
  Argument : 10
 
  ",c9f15957-23d1-4cdb-9e18-10dbb14cb8eb,Active,0.000.00.00,www.REDACTED.com,,Linux Kernel 4.1,,Web Servers,0,0,,,0,0,,,unknown,2024-10-01T04:04:26.550Z,2024-10-01T05:33:17.652Z,,2024-05-15T14:24:55.917Z,2024-10-01T05:33:17.652Z,127d8fef-ce71-558e-cf3a-110f3185c918c096677cdeae28bf,05d3ad30-7e24-467f-978b-366638571a88,2024-10-01T05:40:26.614Z,,2024-10-01T05:32:19Z,True,,0.0,0.0,NONE,11,remote,3.109,www,2024-07-17T00:00:00Z,2001-05-04T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
Vulnerability Scan,11032,,0,,www.REDACTED.com,TCP,443,Web Server Directory Enumeration,It is possible to enumerate directories on the web server.,"This plugin attempts to determine the presence of various common directories on the remote web server.  By sending a request for a directory, the web server response code indicates if it is a valid directory or not.",,http://projects.webappsec.org/w/page/13246953/Predictable%20Resource%20Location,"
The following directories were discovered:
/10, /2, /3, /4, /5, /6, /7, /8, /_themes, /css, /files, /images, /js, /uploads, /themes

While this is not, in and of itself, a bug, you should manually inspect 
these directories to ensure that they are in compliance with company
security standards
",c9f15957-23d1-4cdb-9e18-10dbb14cb8eb,Active,0.000.00.00,www.REDACTED.com,,Linux Kernel 4.1,,Web Servers,0,0,,,0,0,,,unknown,2024-10-01T04:04:26.550Z,2024-10-01T05:33:17.652Z,,2024-05-15T14:24:55.917Z,2024-10-01T05:33:17.652Z,127d8fef-ce71-558e-cf3a-110f3185c918c096677cdeae28bf,05d3ad30-7e24-467f-978b-366638571a88,2024-10-01T05:40:26.607Z,,2024-10-01T05:32:19Z,True,,0.0,0.0,NONE,11,remote,1.115,www,2024-06-07T00:00:00Z,2002-06-26T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
Vulnerability Scan,11219,,0,,www.REDACTED.com,TCP,0,Nessus SYN scanner,It is possible to determine which TCP ports are open.,"This plugin is a SYN 'half-open' port scanner.  It shall be reasonably quick even against a firewalled target. 

Note that SYN scans are less intrusive than TCP (full connect) scans against broken services, but they might cause problems for less robust firewalls and also leave unclosed connections on the remote target, if the network is loaded.",Protect your target with an IP filter.,,"{""listening"":[{""port"":80,""protocol"":""TCP"",""interfaces"":null,""all_interfaces"":false,""service_name"":""www"",""plugin_output"":null},{""port"":443,""protocol"":""TCP"",""interfaces"":null,""all_interfaces"":false,""service_name"":""www"",""plugin_output"":null}],""closed"":{""TCP"":{""discrete"":[],""ranges"":[[1,79],[81,442],[444,65535]]},""UDP"":{""discrete"":[],""ranges"":[[1,79],[81,442],[444,65535]]}}}",c9f15957-23d1-4cdb-9e18-10dbb14cb8eb,Active,0.000.00.00,www.REDACTED.com,,Linux Kernel 4.1,,Port scanners,0,0,,,0,0,,,unknown,2024-10-01T04:04:26.550Z,2024-10-01T05:33:17.652Z,,2024-05-15T14:24:55.917Z,2024-10-01T05:33:17.652Z,127d8fef-ce71-558e-cf3a-110f3185c918c096677cdeae28bf,05d3ad30-7e24-467f-978b-366638571a88,2024-10-01T05:40:26.620Z,,2024-10-01T05:32:19Z,True,,0.0,0.0,NONE,42,remote,1.6,www,2024-05-20T00:00:00Z,2009-02-04T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
Vulnerability Scan,19506,,0,,www.REDACTED.com,TCP,0,Nessus Scan Information,This plugin displays information about the Nessus scan.,"This plugin displays, for each tested host, information about the scan itself :

  - The version of the plugin set.
  - The type of scanner (Nessus or Nessus Home).
  - The version of the Nessus Engine.
  - The port scanner(s) used.
  - The port range scanned.
  - The ping round trip time 
  - Whether credentialed or third-party patch management     checks are possible.
  - Whether the display of superseded patches is enabled
  - The date of the scan.
  - The duration of the scan.
  - The number of hosts scanned in parallel.
  - The number of checks done in parallel.",,,"Information about this scan : 

Nessus version : 10.8.3
Nessus build : 20010
Plugin feed version : 202409302224
Scanner edition used : Nessus
Scanner OS : LINUX
Scanner distribution : amzn2-aarch64
Scan type : Normal
Scan name : Enterprise (REDACTED.com) - WebApp
Scan policy used : Legacy Web App Scan
Scanner IP : tenable Vulnerability Management Scanner (35.86.126.31)
Port scanner(s) : nessus_syn_scanner 
Port range : 1-65535
Ping RTT : 190.802 ms
Thorough tests : yes
Experimental tests : no
Scan for Unpatched Vulnerabilities : no
Plugin debugging enabled : no
Paranoia level : 1
Report verbosity : 1
Safe checks : yes
Optimize the test : no
Credentialed checks : no
Patch management checks : None
Display superseded patches : yes (supersedence plugin did not launch)
CGI scanning : enabled
Web application tests : enabled
Web app tests -  Test mode : all_pairs
Web app tests -  Try all HTTP methods : yes
Web app tests -  Maximum run time : 10 minutes.
Web app tests -  Stop at first flaw : param
Max hosts : 30
Max checks : 4
Recv timeout : 5
Backports : None
Allow post-scan editing : Yes
Nessus Plugin Signature Checking : Enabled
Audit File Signature Checking : Disabled
Scan Start Date : 2024/10/1 4:04 UTC
Scan duration : 5243 sec
Scan for malware : no
",c9f15957-23d1-4cdb-9e18-10dbb14cb8eb,Active,0.000.00.00,www.REDACTED.com,,Linux Kernel 4.1,,Settings,0,0,,,0,0,,,unknown,2024-10-01T04:04:26.550Z,2024-10-01T05:33:17.652Z,,2024-05-15T14:24:55.917Z,2024-10-01T05:33:17.652Z,127d8fef-ce71-558e-cf3a-110f3185c918c096677cdeae28bf,05d3ad30-7e24-467f-978b-366638571a88,2024-10-01T05:40:26.613Z,,2024-10-01T05:32:19Z,True,,0.0,0.0,NONE,41,summary,1.126,,2024-08-05T00:00:00Z,2005-08-26T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
Vulnerability Scan,24260,,0,,www.REDACTED.com,TCP,443,HyperText Transfer Protocol (HTTP) Information,Some information about the remote HTTP configuration can be extracted.,"This test gives some information about the remote HTTP protocol - the version used, whether HTTP Keep-Alive is enabled, etc... 

This test is informational only and does not denote any security problem.",,,"
Response Code : HTTP/1.1 200 OK

Protocol version : HTTP/1.1
HTTP/2 TLS Support: Yes
HTTP/2 Cleartext Support: No
SSL : yes
Keep-Alive : no
Options allowed : (Not implemented)
Headers :

 ",c9f15957-23d1-4cdb-9e18-10dbb14cb8eb,Active,0.000.00.00,www.REDACTED.com,,Linux Kernel 4.1,,Web Servers,0,0,,,0,0,,,unknown,2024-10-01T04:04:26.550Z,2024-10-01T05:33:17.652Z,,2024-05-15T14:24:55.917Z,2024-10-01T05:33:17.652Z,127d8fef-ce71-558e-cf3a-110f3185c918c096677cdeae28bf,05d3ad30-7e24-467f-978b-366638571a88,2024-10-01T05:40:26.606Z,,2024-10-01T05:32:19Z,True,,0.0,0.0,NONE,11,remote,1.15,www,2024-02-26T00:00:00Z,2007-01-30T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
Vulnerability Scan,24260,,0,,www.REDACTED.com,TCP,80,HyperText Transfer Protocol (HTTP) Information,Some information about the remote HTTP configuration can be extracted.,"This test gives some information about the remote HTTP protocol - the version used, whether HTTP Keep-Alive is enabled, etc... 

This test is informational only and does not denote any security problem.",,,"
Response Code : HTTP/1.1 301 Moved Permanently

Protocol version : HTTP/1.1
HTTP/2 TLS Support: No
HTTP/2 Cleartext Support: No
SSL : no
Keep-Alive : no
Options allowed : (Not implemented)
Headers :

  Server: awselb/2.0
  Date: Tue, 01 Oct 2024 04:37:19 GMT
  Content-Type: text/html
  Content-Length: 134
  Connection: keep-alive
  Location: https://www.REDACTED.com:443/
  
Response Body :

",c9f15957-23d1-4cdb-9e18-10dbb14cb8eb,Active,0.000.00.00,www.REDACTED.com,,Linux Kernel 4.1,,Web Servers,0,0,,,0,0,,,unknown,2024-10-01T04:04:26.550Z,2024-10-01T05:33:17.652Z,,2024-05-15T14:24:55.917Z,2024-10-01T05:33:17.652Z,127d8fef-ce71-558e-cf3a-110f3185c918c096677cdeae28bf,05d3ad30-7e24-467f-978b-366638571a88,2024-10-01T05:40:26.616Z,,2024-10-01T05:32:19Z,True,,0.0,0.0,NONE,11,remote,1.15,www,2024-02-26T00:00:00Z,2007-01-30T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,149309,,0,,ro-rds-ec.aws.REDACTED.net,tcp,0,MySQL DB Compliance Checks,Compliance checks for MySQL DB devices.,"""CIS_MySQL_5.7_Community_Benchmark_v2.0.0_Level_2_DB.audit from CIS Oracle MySQL 5.7 Community Edition Benchmark: [null]""

See Also:
https://workbench.cisecurity.org/files/3844

Policy Value:
PASSED",,,,8ac97d64-4f3f-4626-8abc-403bcaa774b5,,172.20.20.12,ro-rds-ec.aws.REDACTED.net,,Debian 7.0 Linux Kernel 3.2,,Policy Compliance,0,0,,,0,0,,,unknown,2024-10-01T07:01:27.297Z,2024-10-01T07:18:37.090Z,,,,34c25e26-1e53-fc8e-8727-55291694e6b61f38ce603be7cd44,2e2564ab-f965-4379-9dca-a4d877b1a490,2024-10-01T07:19:09.077Z,,2024-10-01T07:18:19Z,True,,,,,39,local,,,2024-09-26T00:00:00Z,2022-10-24T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,149309,,0,,ro-rds-ec.aws.REDACTED.net,tcp,0,MySQL DB Compliance Checks,Compliance checks for MySQL DB devices.,"""2.10 Ensure Socket Peer-Credential Authentication is Used Appropriately: [null]""

The server-side auth_socket authentication plugin, authenticates clients that connect to the MySQL server from the local host through the Unix socket file. Users authenticated by the auth_socket need not specify a password when connecting to the server. However, users authenticated by the auth_socket plugin are restricted from connecting remotely; they can only connect from the local host through the Unix socket file. This method is only suitable in situations where the server administrator OS account access is restricted.

Rationale:

This method may be desirable in specific cases, including:

The Linux system where MySQL is running is dedicated to the MySQL server and only the MySQL DBA and OS Admin have access.

When control over user authentication is centralized in the operating system.

It is desirable that audit trails in the database and operating system can use the same user names.

For certain other narrow installation use cases auth_socket may be desirable.

Only local connections for a user.

Impact:

Things to consider when using the operating system to authenticate users:

The user must have an operating system account on the computer which must be accessed.

If a user has logged in using this method and steps away from the terminal, another user could easily log in because this user does not need any passwords or credentials. This could pose a serious security problem.

When an operating system is used to authenticate database users, managing distributed database environments and database links requires special care. Special care must also be taken not to leave such a terminal unlocked and unattended. Hence, we recommend that you carefully evaluate your requirements before opting for auth_socket.

This will not work where distributed connections are required.

Solution:
Add these options under the [mysqld] option group in the MySQL /etc/my.cnf:

plugin-load-add=auth_socket.so
auth_socket=FORCE_PLUS_PERMANENT

For example:

For an OS user which can login to MySQL using auth_socket:

CREATE USER '  i'@'localhost' IDENTIFIED WITH auth_socket;

The user can then login using:

mysql -u <user>

See Also:
https://workbench.cisecurity.org/files/3844

Reference:
800-171|3.4.1, 800-53|CM-8, 800-53r5|CM-8, CN-L3|8.1.10.2(a), CN-L3|8.1.10.2(b), CSCv8|6.6, CSF|DE.CM-7, CSF|ID.AM-1, CSF|ID.AM-2, CSF|PR.DS-3, GDPR|32.1.b, HIPAA|164.306(a)(1), ITSG-33|CM-8, LEVEL|2M, NESA|T1.2.1, NESA|T1.2.2

Policy Value:
PASSED",,,,8ac97d64-4f3f-4626-8abc-403bcaa774b5,,172.20.20.12,ro-rds-ec.aws.REDACTED.net,,Debian 7.0 Linux Kernel 3.2,,Policy Compliance,0,0,,,0,0,,,unknown,2024-10-01T07:01:27.297Z,2024-10-01T07:18:37.090Z,,,,34c25e26-1e53-fc8e-8727-55291694e6b61f38ce603be7cd44,2e2564ab-f965-4379-9dca-a4d877b1a490,2024-10-01T07:19:09.084Z,,2024-10-01T07:18:19Z,True,,,,,39,local,,,2024-09-26T00:00:00Z,2022-10-24T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,149309,,0,Medium,ro-rds-ec.aws.REDACTED.net,tcp,0,MySQL DB Compliance Checks,Compliance checks for MySQL DB devices.,"""6.5 Ensure Audit Logging Is Enabled - audit_log_filter: [ERROR]""

Audit logging is not really included in the Community Edition of MySQL - only the general log. Using the general log is possible, but not practical, because it grows quickly and has an adverse impact on server performance.

Nevertheless, enabling audit logging is an important consideration for a production environment, and third-party tools do exist to help with this. Enable audit logging for

Interactive user sessions

Application sessions (optional)

Rationale:

Audit logging helps to identify who changed what and when. The audit log might be used as evidence in investigations. It might also help to identify what an attacker was able to accomplish.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.

Solution:
Acquire a third-party MySQL logging solution as available from a variety of sources including, but not necessarily limited to, the following:

The General Query Log

MySQL Enterprise Audit

MariaDB Audit Plugin for MySQL

McAfee MySQL Audit

See Also:
https://workbench.cisecurity.org/files/3844

Reference:
800-171|3.3.1, 800-171|3.3.2, 800-171|3.3.6, 800-53|AU-2, 800-53|AU-7, 800-53|AU-12, 800-53r5|AU-2, 800-53r5|AU-7, 800-53r5|AU-12, CN-L3|7.1.2.3(c), CN-L3|8.1.4.3(a), CSCv7|6.2, CSCv8|8.2, CSF|DE.CM-1, CSF|DE.CM-3, CSF|DE.CM-7, CSF|PR.PT-1, CSF|RS.AN-3, GDPR|32.1.b, HIPAA|164.306(a)(1), HIPAA|164.312(b), ITSG-33|AU-2, ITSG-33|AU-7, ITSG-33|AU-12, LEVEL|2M, NESA|M1.2.2, NESA|M5.5.1, NIAv2|AM7, NIAv2|AM11a, NIAv2|AM11b, NIAv2|AM11c, NIAv2|AM11d, NIAv2|AM11e, NIAv2|SS30, NIAv2|VL8, PCI-DSSv3.2.1|10.1, QCSC-v1|3.2, QCSC-v1|6.2, QCSC-v1|8.2.1, QCSC-v1|10.2.1, QCSC-v1|11.2, QCSC-v1|13.2, SWIFT-CSCv1|6.4

Policy Value:
SQL_POLICY
sql_request: SELECT * FROM mysql.audit_log_filter;
sql_expect: REGEX - .+

Error:
3306/mysql:
  ERROR: error retrieving data: [Error packet in response to our COM_QUERY.: Table 'mysql.audit_log_filter' doesn't exist.]",,,,8ac97d64-4f3f-4626-8abc-403bcaa774b5,,172.20.20.12,ro-rds-ec.aws.REDACTED.net,,Debian 7.0 Linux Kernel 3.2,,Policy Compliance,0,0,,,0,0,,,unknown,2024-10-01T07:01:27.297Z,2024-10-01T07:18:37.090Z,,,,34c25e26-1e53-fc8e-8727-55291694e6b61f38ce603be7cd44,2e2564ab-f965-4379-9dca-a4d877b1a490,2024-10-01T07:19:09.091Z,,2024-10-01T07:18:19Z,True,,,,,39,local,$Revision: 1.51 $,,2024-09-26T00:00:00Z,2022-10-24T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,149309,,0,High,ro-rds-ec.aws.REDACTED.net,tcp,0,MySQL DB Compliance Checks,Compliance checks for MySQL DB devices.,"""2.12 Limit Accepted Transport Layer Security (TLS) Versions: [FAILED]""

MySQL supports multiple protocols of TLS. The higher the version the stronger the security and/or better the performance.

Rationale:

Requiring clients attempting to connect to MySQL to use higher versions of TLS to better protect data in transit.

Impact:

Connections attempting to use an unsupported version of TLS or Cipher will fail.

Solution:
Set the version(s) of TLS you wish to accept in mysql.conf specify TLS and Ciphers.

For example to only accept TLS 1.3 set tls_version in my.conf:

tls_version=TLSv1.3

If TLS 1.3 is not supported on the Operating System then set to TLS 1.2:

tls_version=TLSv1.2

Note: with this setting, only clients that support the specified TLS version(s) are able to establish an encrypted connection to the server.

Default Value:

All TLS and cipher versions are enabled by default.

See Also:
https://workbench.cisecurity.org/files/3844

Reference:
800-171|3.1.13, 800-171|3.5.2, 800-171|3.13.8, 800-53|AC-17(2), 800-53|IA-5, 800-53|IA-5(1), 800-53|SA-15, 800-53|SC-8, 800-53|SC-8(1), 800-53r5|AC-17(2), 800-53r5|IA-5, 800-53r5|IA-5(1), 800-53r5|SA-15, 800-53r5|SC-8, 800-53r5|SC-8(1), CN-L3|7.1.2.7(g), CN-L3|7.1.3.1(d), CN-L3|8.1.2.2(a), CN-L3|8.1.2.2(b), CN-L3|8.1.4.1(c), CN-L3|8.1.4.7(a), CN-L3|8.1.4.8(a), CN-L3|8.2.4.5(c), CN-L3|8.2.4.5(d), CN-L3|8.5.2.2, CSCv7|14.4, CSCv7|18.5, CSCv8|3.10, CSCv8|16.11, CSF|PR.AC-1, CSF|PR.AC-3, CSF|PR.DS-2, CSF|PR.DS-5, CSF|PR.IP-2, CSF|PR.PT-4, GDPR|32.1.a, GDPR|32.1.b, HIPAA|164.306(a)(1), HIPAA|164.312(a)(1), HIPAA|164.312(a)(2)(i), HIPAA|164.312(d), HIPAA|164.312(e)(1), HIPAA|164.312(e)(2)(i), ISO/IEC-27001|A.6.2.2, ISO/IEC-27001|A.10.1.1, ISO/IEC-27001|A.13.2.3, ITSG-33|AC-17(2), ITSG-33|IA-5, ITSG-33|IA-5(1), ITSG-33|SC-8, ITSG-33|SC-8a., ITSG-33|SC-8(1), LEVEL|2A, NESA|T4.3.1, NESA|T4.3.2, NESA|T4.5.1, NESA|T4.5.2, NESA|T5.2.3, NESA|T5.4.2, NESA|T7.3.3, NESA|T7.4.1, NIAv2|AM37, NIAv2|IE8, NIAv2|IE9, NIAv2|IE12, NIAv2|NS5d, NIAv2|NS6b, NIAv2|NS29, NIAv2|SS5, NIAv2|SS6a, NIAv2|SS24, PCI-DSSv3.2.1|2.3, PCI-DSSv3.2.1|4.1, PCI-DSSv4.0|2.2.7, PCI-DSSv4.0|4.2.1, QCSC-v1|3.2, QCSC-v1|4.2, QCSC-v1|5.2.1, QCSC-v1|5.2.2, QCSC-v1|6.2, QCSC-v1|13.2, SWIFT-CSCv1|2.1, SWIFT-CSCv1|2.6, SWIFT-CSCv1|4.1, TBA-FIISB|29.1

Policy Value:
SQL_POLICY
sql_request: select @@tls_version;
sql_expect: REGEX - ^TLSv1\.(2|3)(,|$)

Actual Value:
3306/mysql:
  [""TLSv1,TLSv1.1,TLSv1.2""]",,,,8ac97d64-4f3f-4626-8abc-403bcaa774b5,,172.20.20.12,ro-rds-ec.aws.REDACTED.net,,Debian 7.0 Linux Kernel 3.2,,Policy Compliance,0,0,,,0,0,,,unknown,2024-10-01T07:01:27.297Z,2024-10-01T07:18:37.090Z,,,,34c25e26-1e53-fc8e-8727-55291694e6b61f38ce603be7cd44,2e2564ab-f965-4379-9dca-a4d877b1a490,2024-10-01T07:19:09.095Z,,2024-10-01T07:18:19Z,True,,,,,39,local,$Revision: 1.51 $,,2024-09-26T00:00:00Z,2022-10-24T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,72426,,0,Medium,amazon aws,tcp,0,Amazon AWS Compliance Checks,Compliance checks for Amazon Web Services.,"""4.6 Ensure AWS Management Console authentication failures are monitored: [WARNING]""

Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs, or an external Security information and event management (SIEM) environment, and establishing corresponding metric filters and alarms.

It is recommended that a metric filter and alarm be established for failed console authentication attempts.

Rationale:

CloudWatch is an AWS native service that allows you to observe and monitor resources and applications. CloudTrail Logs can also be sent to an external Security information and event management (SIEM) environment for monitoring and alerting.

Monitoring failed console logins may decrease lead time to detect an attempt to brute force a credential, which may provide an indicator, such as source IP address, that can be used in other event correlation.

Impact:

Monitoring for these failures may create a large number of alerts, more so in larger environments.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.

Solution:
If you are using CloudTrails and CloudWatch, perform the following to setup the metric filter, alarm, SNS topic, and subscription:

Create a metric filter based on filter pattern provided which checks for AWS management Console Login Failures and the <cloudtrail_log_group_name> taken from audit step 1.

aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name  '<console_signin_failure_metric>'  --metric-transformations metricName= '<console_signin_failure_metric>' ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = ConsoleLogin) && ($.errorMessage = 'Failed authentication') }'

Note: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.

Create an SNS topic that the alarm will notify

aws sns create-topic --name <sns_topic_name>

Note: you can execute this command once and then re-use the same topic for all monitoring alarms.

Create an SNS subscription to the topic created in step 2

aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints>

Note: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.

Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2

aws cloudwatch put-metric-alarm --alarm-name  '<console_signin_failure_alarm>'  --metric-name  '<console_signin_failure_metric>'  --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn>

See Also:
https://workbench.cisecurity.org/benchmarks/14207

Reference:
800-171|3.3.1, 800-171|3.3.2, 800-171|3.3.6, 800-53|AU-6, 800-53|AU-6(1), 800-53|AU-7(1), 800-53r5|AU-6, 800-53r5|AU-6(1), 800-53r5|AU-7(1), CCE|CCE-79191-3, CN-L3|7.1.2.3(c), CN-L3|7.1.3.3(d), CSCv7|16, CSCv8|8.11, CSF|DE.AE-2, CSF|DE.AE-3, CSF|DE.DP-4, CSF|PR.PT-1, CSF|RS.AN-1, CSF|RS.AN-3, CSF|RS.CO-2, GDPR|32.1.b, HIPAA|164.306(a)(1), HIPAA|164.312(b), ITSG-33|AU-6, ITSG-33|AU-6(1), ITSG-33|AU-7(1), LEVEL|2M, NESA|M5.2.5, QCSC-v1|5.2.3, QCSC-v1|8.2.1, QCSC-v1|10.2.1, QCSC-v1|11.2, QCSC-v1|13.2, SWIFT-CSCv1|6.4

Policy Value:
WARNING

Actual Value:
WARNING",,,,d01bf204-427a-5177-a7b5-6da1c76f8dcd,,,amazon aws,,,,Policy Compliance,0,0,,,0,0,,,,2024-10-01T09:00:16.032Z,2024-10-01T09:10:27.157Z,,,,template-5c9b270a-a184-2ba3-22de-3a8c0221d4daad6b27cc0b518808,1bc01c9b-fef6-43b8-a79e-1b876b79ace5,2024-10-01T09:11:31.837Z,,,False,,,,,39,local,$Revision: 1.475 $,,2024-09-26T00:00:00Z,2014-04-15T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,72426,,0,Medium,amazon aws,tcp,0,Amazon AWS Compliance Checks,Compliance checks for Amazon Web Services.,"""2.1.3 Ensure all data in Amazon S3 has been discovered, classified and secured when required.: [WARNING]""

Amazon S3 buckets can contain sensitive data, that for security purposes should be discovered, monitored, classified and protected. Macie along with other 3rd party tools can automatically provide an inventory of Amazon S3 buckets.

Rationale:

Using a Cloud service or 3rd Party software to continuously monitor and automate the process of data discovery and classification for S3 buckets using machine learning and pattern matching is a strong defense in protecting that information.

Amazon Macie is a fully managed data security and data privacy service that uses machine learning and pattern matching to discover and protect your sensitive data in AWS.

Impact:

There is a cost associated with using Amazon Macie. There is also typically a cost associated with 3rd Party tools that perform similar processes and protection.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.

Solution:
Perform the steps below to enable and configure Amazon Macie
From Console:

Log on to the Macie console at https://console.aws.amazon.com/macie/

Click Get started.

Click Enable Macie.

Setup a repository for sensitive data discovery results

In the Left pane, under Settings, click Discovery results.

Make sure Create bucket is selected.

Create a bucket, enter a name for the bucket. The name must be unique across all S3 buckets. In addition, the name must start with a lowercase letter or a number.

Click on Advanced.

Block all public access, make sure Yes is selected.

KMS encryption, specify the AWS KMS key that you want to use to encrypt the results. The key must be a symmetric, customer master key (CMK) that's in the same Region as the S3 bucket.

Click on Save

Create a job to discover sensitive data

In the left pane, click S3 buckets. Macie displays a list of all the S3 buckets for your account.

Select the check box for each bucket that you want Macie to analyze as part of the job

Click Create job.

Click Quick create.

For the Name and description step, enter a name and, optionally, a description of the job.

Then click Next.

For the Review and create step, click Submit.

Review your findings

In the left pane, click Findings.

To view the details of a specific finding, choose any field other than the check box for the finding.

If you are using a 3rd Party tool to manage and protect your s3 data, follow the Vendor documentation for implementing and configuring that tool.

See Also:
https://workbench.cisecurity.org/benchmarks/14207

Reference:
800-53|AU-11, 800-53|SI-12, 800-53r5|AU-11, 800-53r5|SI-12, CSCv7|5.1, CSCv8|3.1, CSF|PR.PT-1, GDPR|32.1.b, HIPAA|164.306(a)(1), HIPAA|164.312(b), ITSG-33|AU-11, ITSG-33|SI-12, ITSG-33|SI-12a., LEVEL|2M, NESA|M5.2.3, NESA|M5.2.4, NESA|M5.3.1, NESA|T3.6.2, NIAv2|DR1, NIAv2|DR1a, NIAv2|DR1b, NIAv2|DR1c, NIAv2|DR2, NIAv2|DR3, NIAv2|DR4, NIAv2|DR5, NIAv2|DR6, NIAv2|SM7, PCI-DSSv3.2.1|3.1, PCI-DSSv3.2.1|10.7, PCI-DSSv4.0|3.2.1, PCI-DSSv4.0|10.5.1, QCSC-v1|8.2.1, QCSC-v1|13.2

Policy Value:
WARNING

Actual Value:
WARNING",,,,d01bf204-427a-5177-a7b5-6da1c76f8dcd,,,amazon aws,,,,Policy Compliance,0,0,,,0,0,,,,2024-10-01T09:00:16.032Z,2024-10-01T09:10:27.157Z,,,,template-5c9b270a-a184-2ba3-22de-3a8c0221d4daad6b27cc0b518808,1bc01c9b-fef6-43b8-a79e-1b876b79ace5,2024-10-01T09:11:31.843Z,,,False,,,,,39,local,$Revision: 1.475 $,,2024-09-26T00:00:00Z,2014-04-15T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,72426,,0,High,amazon aws,tcp,0,Amazon AWS Compliance Checks,Compliance checks for Amazon Web Services.,"""3.3 Ensure AWS Config is enabled in all regions: [FAILED]""

AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. It is recommended AWS Config be enabled in all regions.

Rationale:

The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing.

Impact:

It is recommended AWS Config be enabled in all regions.

Solution:
To implement AWS Config configuration:
From Console:

Select the region you want to focus on in the top right of the console

Click Services

Click Config

If a Config recorder is enabled in this region, you should navigate to the Settings page from the navigation menu on the left hand side. If a Config recorder is not yet enabled in this region then you should select 'Get Started'.

Select 'Record all resources supported in this region'

Choose to include global resources (IAM resources)

Specify an S3 bucket in the same account or in another managed AWS account

Create an SNS Topic from the same AWS account or another managed AWS account

From Command Line:

Ensure there is an appropriate S3 bucket, SNS topic, and IAM role per the AWS Config Service prerequisites.

Run this command to create a new configuration recorder:

aws configservice put-configuration-recorder --configuration-recorder name=default,roleARN=arn:aws:iam::012345678912:role/myConfigRole --recording-group allSupported=true,includeGlobalResourceTypes=true

Create a delivery channel configuration file locally which specifies the channel attributes, populated from the prerequisites set up previously:

{
  'name': 'default',
  's3BucketName': 'my-config-bucket',
  'snsTopicARN': 'arn:aws:sns:us-east-1:012345678912:my-config-notice',
  'configSnapshotDeliveryProperties': {
    'deliveryFrequency': 'Twelve_Hours'
  }
}

Run this command to create a new delivery channel, referencing the json configuration file made in the previous step:

aws configservice put-delivery-channel --delivery-channel file://deliveryChannel.json

Start the configuration recorder by running the following command:

aws configservice start-configuration-recorder --configuration-recorder-name default

See Also:
https://workbench.cisecurity.org/benchmarks/14207

Reference:
800-171|3.4.1, 800-53|CM-8, 800-53|CM-8(1), 800-53|PM-5, 800-53r5|CM-8, 800-53r5|CM-8(1), 800-53r5|PM-5, CCE|CCE-78917-2, CN-L3|8.1.10.2(a), CN-L3|8.1.10.2(b), CSCv7|1.4, CSCv7|11.2, CSCv7|16.1, CSCv8|1.1, CSF|DE.CM-7, CSF|ID.AM-1, CSF|ID.AM-2, CSF|PR.DS-3, GDPR|32.1.b, GDPR|32.1.d, HIPAA|164.306(a)(1), ITSG-33|CM-8, ITSG-33|CM-8(1), LEVEL|2A, NESA|T1.2.1, NESA|T1.2.2, QCSC-v1|3.2, QCSC-v1|5.2.2, QCSC-v1|5.2.3, QCSC-v1|6.2, QCSC-v1|8.2.1

Policy Value:
FAILED

Actual Value:
All of the following must pass to satisfy this requirement:

-------------------------
FAILED - 'Record all resources supported in this region'
ap-northeast-1:
  No lines matching regex found. 
ap-northeast-2:
  No lines matching regex found. 
ap-northeast-3:
  No lines matching regex found. 
ap-south-1:
  No lines matching regex found. 
eu-north-1:
  No lines matching regex found. 
eu-west-1:
  No lines matching regex found. 
sa-east-1:
  No lines matching regex found. 
us-east-1:
  No lines matching expect found. 
us-west-1:
  No lines matching regex found. 
us-west-2:
  No lines matching regex found. 

ap-northeast-1:
  No matches found.
ap-northeast-2:
  No matches found.
ap-northeast-3:
  No matches found.
ap-south-1:
  No matches found.
ap-southeast-1:
  Name: default - Record all resources supported in this region = true
ap-southeast-2:
  Name: default - Record all resources supported in this region = true
ca-central-1:
  Name: default - Record all resources supported in this region = true
eu-central-1:
  Name: default - Record all resources supported in this region = true
eu-north-1:
  No matches found.
eu-west-1:
  No matches found.
eu-west-2:
  Name: default - Record all resources supported in this region = true
eu-west-3:
  Name: default - Record all resources supported in this region = true
sa-east-1:
  No matches found.
us-east-1:
  Name: security-config-recorder - Record all resources supported in this region = false
us-east-2:
  Name: default - Record all resources supported in this region = true
us-west-1:
  No matches found.
us-west-2:
  No matches found.


-------------------------
FAILED - 'Include global resources'
ap-northeast-1:
No lines matching regex found. 
ap-northeast-2:
No lines matching regex found. 
ap-northeast-3:
No lines matching regex found. 
ap-south-1:
No lines matching regex found. 
ap-southeast-1:
No lines matching expect found. 
ap-southeast-2:
No lines matching expect found. 
ca-central-1:
No lines matching expect found. 
eu-central-1:
No lines matching expect found. 
eu-north-1:
No lines matching regex found. 
eu-west-1:
No lines matching regex found. 
eu-west-2:
No lines matching expect found. 
eu-west-3:
No lines matching expect found. 
sa-east-1:
No lines matching regex found. 
us-east-1:
No lines matching expect found. 
us-east-2:
No lines matching expect found. 
us-west-1:
No lines matching regex found. 
us-west-2:
No lines matching regex found. 

ap-northeast-1:
No matches found.
ap-northeast-2:
No matches found.
ap-northeast-3:
No matches found.
ap-south-1:
No matches found.
ap-southeast-1:
Name: default - Include global resources = false
ap-southeast-2:
Name: default - Include global resources = false
ca-central-1:
Name: default - Include global resources = false
eu-central-1:
Name: default - Include global resources = false
eu-north-1:
No matches found.
eu-west-1:
No matches found.
eu-west-2:
Name: default - Include global resources = false
eu-west-3:
Name: default - Include global resources = false
sa-east-1:
No matches found.
us-east-1:
Name: security-config-recorder - Include global resources = false
us-east-2:
Name: default - Include global resources = false
us-west-1:
No matches found.
us-west-2:
No matches found.


-------------------------
FAILED - 'Recording Status'
ap-northeast-1:
  No lines matching regex found. 
ap-northeast-2:
  No lines matching regex found. 
ap-northeast-3:
  No lines matching regex found. 
ap-south-1:
  No lines matching regex found. 
ap-southeast-1:
  No lines matching expect found. 
ap-southeast-2:
  No lines matching expect found. 
ca-central-1:
  No lines matching expect found. 
eu-central-1:
  No lines matching expect found. 
eu-north-1:
  No lines matching regex found. 
eu-west-1:
  No lines matching regex found. 
eu-west-2:
  No lines matching expect found. 
eu-west-3:
  No lines matching expect found. 
sa-east-1:
  No lines matching regex found. 
us-east-1:
  No lines matching expect found. 
us-west-1:
  No lines matching regex found. 
us-west-2:
  No lines matching regex found. 

ap-northeast-1:
  No matches found.
ap-northeast-2:
  No matches found.
ap-northeast-3:
  No matches found.
ap-south-1:
  No matches found.
ap-southeast-1:
  default - Recording = No Recording setting found
ap-southeast-2:
  default - Recording = No Recording setting found
ca-central-1:
  default - Recording = No Recording setting found
eu-central-1:
  default - Recording = No Recording setting found
eu-north-1:
  No matches found.
eu-west-1:
  No matches found.
eu-west-2:
  default - Recording = No Recording setting found
eu-west-3:
  default - Recording = No Recording setting found
sa-east-1:
  No matches found.
us-east-1:
  security-config-recorder - Recording = No Recording setting found
us-east-2:
  default - Recording = true
us-west-1:
  No matches found.
us-west-2:
  No matches found.


-------------------------
FAILED - 'Review defined S3 Bucket'
ap-northeast-1:
  No lines matching regex found. 
ap-northeast-2:
  No lines matching regex found. 
ap-northeast-3:
  No lines matching regex found. 
ap-south-1:
  No lines matching regex found. 
eu-north-1:
  No lines matching regex found. 
eu-west-1:
  No lines matching regex found. 
sa-east-1:
  No lines matching regex found. 
us-west-1:
  No lines matching regex found. 
us-west-2:
  No lines matching regex found. 

ap-northeast-1:
  No matches found.
ap-northeast-2:
  No matches found.
ap-northeast-3:
  No matches found.
ap-south-1:
  No matches found.
ap-southeast-1:
  default - S3 Bucket = vwops.ap-southeast-1
ap-southeast-2:
  default - S3 Bucket = vwops.ap-southeast-2
ca-central-1:
  default - S3 Bucket = vwops.ca-central-1
eu-central-1:
  default - S3 Bucket = vwops.eu-central-1
eu-north-1:
  No matches found.
eu-west-1:
  No matches found.
eu-west-2:
  default - S3 Bucket = vwops.eu-west-2
eu-west-3:
  default - S3 Bucket = vwops.eu-west-3
sa-east-1:
  No matches found.
us-east-1:
  security-config-recorder-delivery - S3 Bucket = vwops.us-east-1
us-east-2:
  default - S3 Bucket = vwops.us-east-2
us-west-1:
  No matches found.
us-west-2:
  No matches found.


-------------------------
FAILED - 'Review defined SNS Topic'
ap-northeast-1:
  No lines matching regex found. 
ap-northeast-2:
  No lines matching regex found. 
ap-northeast-3:
  No lines matching regex found. 
ap-south-1:
  No lines matching regex found. 
eu-north-1:
  No lines matching regex found. 
eu-west-1:
  No lines matching regex found. 
sa-east-1:
  No lines matching regex found. 
us-west-1:
  No lines matching regex found. 
us-west-2:
  No lines matching regex found. 

ap-northeast-1:
  No matches found.
ap-northeast-2:
  No matches found.
ap-northeast-3:
  No matches found.
ap-south-1:
  No matches found.
ap-southeast-1:
  default - SNS Topic ARN = arn:aws:sns:ap-southeast-1:623976975596:AWSConfig-Notifications
ap-southeast-2:
  default - SNS Topic ARN = arn:aws:sns:ap-southeast-2:623976975596:AWSConfig-Notifications
ca-central-1:
  default - SNS Topic ARN = arn:aws:sns:ca-central-1:623976975596:AWSConfig-Notifications
eu-central-1:
  default - SNS Topic ARN = arn:aws:sns:eu-central-1:623976975596:AWSConfig-Notifications
eu-north-1:
  No matches found.
eu-west-1:
  No matches found.
eu-west-2:
  default - SNS Topic ARN = arn:aws:sns:eu-west-2:623976975596:AWSConfig-Notifications
eu-west-3:
  default - SNS Topic ARN = arn:aws:sns:eu-west-3:623976975596:AWSConfig-Notifications
sa-east-1:
  No matches found.
us-east-1:
  security-config-recorder-delivery - SNS Topic ARN = arn:aws:sns:us-east-1:623976975596:AWSConfig-Notifications
us-east-2:
  default - SNS Topic ARN = arn:aws:sns:us-east-2:623976975596:AWSConfig-Notifications
us-west-1:
  No matches found.
us-west-2:
  No matches found.
",,,,d01bf204-427a-5177-a7b5-6da1c76f8dcd,,,amazon aws,,,,Policy Compliance,0,0,,,0,0,,,,2024-10-01T09:00:16.032Z,2024-10-01T09:10:27.157Z,,,,template-5c9b270a-a184-2ba3-22de-3a8c0221d4daad6b27cc0b518808,1bc01c9b-fef6-43b8-a79e-1b876b79ace5,2024-10-01T09:11:31.844Z,,,False,,,,,39,local,$Revision: 1.475 $,,2024-09-26T00:00:00Z,2014-04-15T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,72426,,0,Medium,amazon aws,tcp,0,Amazon AWS Compliance Checks,Compliance checks for Amazon Web Services.,"""3.9 Ensure that Object-level logging for read events is enabled for S3 bucket: [WARNING]""

S3 object-level API operations such as GetObject, DeleteObject, and PutObject are called data events. By default, CloudTrail trails don't log data events and so it is recommended to enable Object-level logging for S3 buckets.

Rationale:

Enabling object-level logging will help you meet data compliance requirements within your organization, perform comprehensive security analysis, monitor specific patterns of user behavior in your AWS account or take immediate actions on any object-level API activity using Amazon CloudWatch Events.

Impact:

Enabling logging for these object level events may significantly increase the number of events logged and may incur additional cost.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.

Solution:
From Console:

Login to the AWS Management Console and navigate to S3 dashboard at https://console.aws.amazon.com/s3/

In the left navigation panel, click buckets and then click on the S3 Bucket Name that you want to examine.

Click Properties tab to see in detail bucket configuration.

In the AWS Cloud Trail data events' section select the CloudTrail name for the recording activity. You can choose an existing Cloudtrail or create a new one by slicking the Configure in Cloudtrailbutton or navigating to the Cloudtrail console linkhttps://console.aws.amazon.com/cloudtrail/'

Once the Cloudtrail is selected, Select the data Data Events check box.

Select S3 from the 'Data event type drop down.

Select Log all events from the Log selector template drop down.

Repeat steps 2 to 5 to enable object-level logging of write events for other S3 buckets.

From Command Line:

To enable object-level data events logging for S3 buckets within your AWS account, run put-event-selectors command using the name of the trail that you want to reconfigure as identifier:

aws cloudtrail put-event-selectors --region <region-name> --trail-name <trail-name> --event-selectors '[{ 'ReadWriteType': 'ReadOnly', 'IncludeManagementEvents':true, 'DataResources': [{ 'Type': 'AWS::S3::Object', 'Values': ['arn:aws:s3:::<s3-bucket-name>/'] }] }]'

The command output will be object-level event trail configuration.

If you want to enable it for all buckets at once then change Values parameter to ['arn:aws:s3'] in command given above.

Repeat step 1 for each s3 bucket to update object-level logging of read events.

Change the AWS region by updating the --region command parameter and perform the process for other regions.

See Also:
https://workbench.cisecurity.org/benchmarks/14207

Reference:
800-171|3.3.1, 800-171|3.3.2, 800-171|3.3.6, 800-53|AU-3, 800-53|AU-3(1), 800-53|AU-7, 800-53|AU-12, 800-53r5|AU-3, 800-53r5|AU-3(1), 800-53r5|AU-7, 800-53r5|AU-12, CN-L3|7.1.2.3(a), CN-L3|7.1.2.3(b), CN-L3|7.1.2.3(c), CN-L3|7.1.3.3(a), CN-L3|7.1.3.3(b), CN-L3|8.1.4.3(b), CSCv7|6.2, CSCv7|6.3, CSCv8|8.5, CSF|DE.CM-1, CSF|DE.CM-3, CSF|DE.CM-7, CSF|PR.PT-1, CSF|RS.AN-3, GDPR|32.1.b, HIPAA|164.306(a)(1), HIPAA|164.312(b), ITSG-33|AU-3, ITSG-33|AU-3(1), ITSG-33|AU-7, ITSG-33|AU-12, LEVEL|2A, NESA|T3.6.2, NIAv2|AM34a, NIAv2|AM34b, NIAv2|AM34c, NIAv2|AM34d, NIAv2|AM34e, NIAv2|AM34f, NIAv2|AM34g, PCI-DSSv3.2.1|10.1, PCI-DSSv3.2.1|10.3, PCI-DSSv3.2.1|10.3.1, PCI-DSSv3.2.1|10.3.2, PCI-DSSv3.2.1|10.3.3, PCI-DSSv3.2.1|10.3.4, PCI-DSSv3.2.1|10.3.5, PCI-DSSv3.2.1|10.3.6, PCI-DSSv4.0|10.2.2, QCSC-v1|3.2, QCSC-v1|6.2, QCSC-v1|8.2.1, QCSC-v1|10.2.1, QCSC-v1|11.2, QCSC-v1|13.2, SWIFT-CSCv1|6.4

Policy Value:
WARNING

Actual Value:
WARNING",,,,d01bf204-427a-5177-a7b5-6da1c76f8dcd,,,amazon aws,,,,Policy Compliance,0,0,,,0,0,,,,2024-10-01T09:00:16.032Z,2024-10-01T09:10:27.157Z,,,,template-5c9b270a-a184-2ba3-22de-3a8c0221d4daad6b27cc0b518808,1bc01c9b-fef6-43b8-a79e-1b876b79ace5,2024-10-01T09:11:31.844Z,,,False,,,,,39,local,$Revision: 1.475 $,,2024-09-26T00:00:00Z,2014-04-15T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,72426,,0,Medium,amazon aws,tcp,0,Amazon AWS Compliance Checks,Compliance checks for Amazon Web Services.,"""4.9 Ensure AWS Config configuration changes are monitored: [WARNING]""

Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs, or an external Security information and event management (SIEM) environment, and establishing corresponding metric filters and alarms.

It is recommended that a metric filter and alarm be established for detecting changes to AWS Config's configurations.

Rationale:

Monitoring changes to AWS Config configuration will help ensure sustained visibility of configuration items within the AWS account.

CloudWatch is an AWS native service that allows you to observe and monitor resources and applications. CloudTrail Logs can also be sent to an external Security information and event management (SIEM) environment for monitoring and alerting.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.

Solution:
If you are using CloudTrails and CloudWatch, perform the following to setup the metric filter, alarm, SNS topic, and subscription:

Create a metric filter based on filter pattern provided which checks for AWS Configuration changes and the <cloudtrail_log_group_name> taken from audit step 1.

aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name  '<aws_config_changes_metric>'  --metric-transformations metricName= '<aws_config_changes_metric>' ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventSource = config.amazonaws.com) && (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder)) }'

Note: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.

Create an SNS topic that the alarm will notify

aws sns create-topic --name <sns_topic_name>

Note: you can execute this command once and then re-use the same topic for all monitoring alarms.

Create an SNS subscription to topic created in step 2

aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints>

Note: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.

Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2

aws cloudwatch put-metric-alarm --alarm-name  '<aws_config_changes_alarm>'  --metric-name  '<aws_config_changes_metric>'  --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn>

See Also:
https://workbench.cisecurity.org/benchmarks/14207

Reference:
800-171|3.3.1, 800-171|3.3.2, 800-171|3.3.6, 800-53|AU-6, 800-53|AU-6(1), 800-53|AU-7(1), 800-53r5|AU-6, 800-53r5|AU-6(1), 800-53r5|AU-7(1), CCE|CCE-79194-7, CN-L3|7.1.2.3(c), CN-L3|7.1.3.3(d), CSCv7|1.4, CSCv7|11.2, CSCv7|16.1, CSCv8|8.11, CSF|DE.AE-2, CSF|DE.AE-3, CSF|DE.DP-4, CSF|PR.PT-1, CSF|RS.AN-1, CSF|RS.AN-3, CSF|RS.CO-2, GDPR|32.1.b, HIPAA|164.306(a)(1), HIPAA|164.312(b), ITSG-33|AU-6, ITSG-33|AU-6(1), ITSG-33|AU-7(1), LEVEL|2M, NESA|M5.2.5, QCSC-v1|5.2.3, QCSC-v1|8.2.1, QCSC-v1|10.2.1, QCSC-v1|11.2, QCSC-v1|13.2, SWIFT-CSCv1|6.4

Policy Value:
WARNING

Actual Value:
WARNING",,,,d01bf204-427a-5177-a7b5-6da1c76f8dcd,,,amazon aws,,,,Policy Compliance,0,0,,,0,0,,,,2024-10-01T09:00:16.032Z,2024-10-01T09:10:27.157Z,,,,template-5c9b270a-a184-2ba3-22de-3a8c0221d4daad6b27cc0b518808,1bc01c9b-fef6-43b8-a79e-1b876b79ace5,2024-10-01T09:11:31.844Z,,,False,,,,,39,local,$Revision: 1.475 $,,2024-09-26T00:00:00Z,2014-04-15T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
STIG Scan,72426,,0,,amazon aws,tcp,0,Amazon AWS Compliance Checks,Compliance checks for Amazon Web Services.,"""3.2 Ensure CloudTrail log file validation is enabled: [PASSED]""

CloudTrail log file validation creates a digitally signed digest file containing a hash of each log that CloudTrail writes to S3. These digest files can be used to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log. It is recommended that file validation be enabled on all CloudTrails.

Rationale:

Enabling log file validation will provide additional integrity checking of CloudTrail logs.

Solution:
Perform the following to enable log file validation on a given trail:
From Console:

Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/cloudtrail

Click on Trails on the left navigation pane

Click on target trail

Within the General details section click edit

Under the Advanced settings section

Check the enable box under Log file validation

Click Save changes

From Command Line:

aws cloudtrail update-trail --name <trail_name> --enable-log-file-validation

Note that periodic validation of logs using these digests can be performed by running the following command:

aws cloudtrail validate-logs --trail-arn <trail_arn> --start-time <start_time> --end-time <end_time>

Default Value:

Not Enabled

See Also:
https://workbench.cisecurity.org/benchmarks/14207

Reference:
800-171|3.3.1, 800-171|3.3.2, 800-171|3.3.6, 800-53|AU-6, 800-53|AU-6(1), 800-53|AU-7(1), 800-53r5|AU-6, 800-53r5|AU-6(1), 800-53r5|AU-7(1), CCE|CCE-78914-9, CN-L3|7.1.2.3(c), CN-L3|7.1.3.3(d), CSCv7|6, CSCv8|8.11, CSF|DE.AE-2, CSF|DE.AE-3, CSF|DE.DP-4, CSF|PR.PT-1, CSF|RS.AN-1, CSF|RS.AN-3, CSF|RS.CO-2, GDPR|32.1.b, HIPAA|164.306(a)(1), HIPAA|164.312(b), ITSG-33|AU-6, ITSG-33|AU-6(1), ITSG-33|AU-7(1), LEVEL|2A, NESA|M5.2.5, QCSC-v1|5.2.3, QCSC-v1|8.2.1, QCSC-v1|10.2.1, QCSC-v1|11.2, QCSC-v1|13.2, SWIFT-CSCv1|6.4

Policy Value:
CLOUDTRAIL
aws_action: DescribeTrails
regex: LogFileValidationEnabled = 
expect: LogFileValidationEnabled = true

Actual Value:
ap-northeast-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
ap-northeast-2:
  cloudtrail-api-logs - LogFileValidationEnabled = true
ap-northeast-3:
  cloudtrail-api-logs - LogFileValidationEnabled = true
ap-south-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
ap-southeast-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
ap-southeast-2:
  cloudtrail-api-logs - LogFileValidationEnabled = true
ca-central-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
eu-central-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
eu-north-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
eu-west-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
eu-west-2:
  cloudtrail-api-logs - LogFileValidationEnabled = true
eu-west-3:
  cloudtrail-api-logs - LogFileValidationEnabled = true
sa-east-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
us-east-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
us-east-2:
  cloudtrail-api-logs - LogFileValidationEnabled = true
us-west-1:
  cloudtrail-api-logs - LogFileValidationEnabled = true
us-west-2:
  cloudtrail-api-logs - LogFileValidationEnabled = true",,,,d01bf204-427a-5177-a7b5-6da1c76f8dcd,,,amazon aws,,,,Policy Compliance,0,0,,,0,0,,,,2024-10-01T09:00:16.032Z,2024-10-01T09:10:27.157Z,,,,template-5c9b270a-a184-2ba3-22de-3a8c0221d4daad6b27cc0b518808,1bc01c9b-fef6-43b8-a79e-1b876b79ace5,2024-10-01T09:11:31.844Z,,,False,,,,,39,local,$Revision: 1.475 $,,2024-09-26T00:00:00Z,2014-04-15T00:00:00Z,False,False,False,False,False,False,False,False,False,False,False,False,False,
